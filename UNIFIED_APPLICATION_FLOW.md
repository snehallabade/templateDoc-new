# Document Template Processor - Unified Application Flow

## ğŸ”„ Complete End-to-End Application Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                              DOCUMENT TEMPLATE PROCESSOR - UNIFIED FLOW                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    USER                    FRONTEND                    API ROUTER                DOCUMENT PROCESSOR           EXTERNAL SERVICES              STORAGE LAYER              DATABASE
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚                           â”‚                         â”‚
     â”‚ 1. Select Template      â”‚                           â”‚                            â”‚                           â”‚                           â”‚                         â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                           â”‚                            â”‚                           â”‚                           â”‚                         â”‚
     â”‚                         â”‚ 2. Validate File         â”‚                            â”‚                           â”‚                           â”‚                         â”‚
     â”‚                         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚                            â”‚                           â”‚                           â”‚                         â”‚
     â”‚                         â”‚         â”‚                 â”‚                            â”‚                           â”‚                           â”‚                         â”‚
     â”‚                         â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚                            â”‚                           â”‚                           â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚                           â”‚                         â”‚
     â”‚                         â”‚ 3. POST /api/templates    â”‚                            â”‚                           â”‚                           â”‚                         â”‚
     â”‚                         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                            â”‚                           â”‚                           â”‚                         â”‚
     â”‚                         â”‚                           â”‚ 4. Route to Handler        â”‚                           â”‚                           â”‚                         â”‚
     â”‚                         â”‚                           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                           â”‚                           â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚ 5. Check File Type        â”‚                           â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚                           â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚         â”‚                 â”‚                           â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚                           â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚                           â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚ 6a. Extract DOCX Placeholders                        â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                           â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚ 7a. Easy-Template-X       â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚         â”‚                 â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚ 8a. Return Placeholders   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                           â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚                           â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚ 6b. Extract XLSX Placeholders                        â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                           â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚ 7b. ExcelJS Processing    â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚         â”‚                 â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚ 8b. Return Placeholders   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                           â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚                           â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚ 9. Upload to Storage      â”‚                           â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚                           â”‚ 10. Supabase Upload      â”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚                           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚                           â”‚         â”‚               â”‚
     â”‚                         â”‚                           â”‚                            â”‚ 11. Storage URL           â”‚                           â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
     â”‚                         â”‚                           â”‚                            â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚                           â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚ 12. Save Template Record â”‚                           â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚                           â”‚                         â”‚ 13. Database Insert
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚                           â”‚                         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚                           â”‚                         â”‚         â”‚
     â”‚                         â”‚                           â”‚                            â”‚ 14. Template ID           â”‚                           â”‚                         â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                         â”‚                           â”‚                            â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚                         â”‚                           â”‚ 15. Success Response       â”‚                           â”‚                           â”‚                         â”‚
     â”‚                         â”‚                           â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                           â”‚                           â”‚                         â”‚
     â”‚                         â”‚ 16. Template + Placeholdersâ”‚                           â”‚                           â”‚                           â”‚                         â”‚
     â”‚                         â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                           â”‚                           â”‚                           â”‚                         â”‚
     â”‚ 17. Show Placeholder Formâ”‚                          â”‚                           â”‚                           â”‚                           â”‚                         â”‚
     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                           â”‚                           â”‚                           â”‚                           â”‚                         â”‚
     â”‚                         â”‚                           â”‚                           â”‚                           â”‚                           â”‚                         â”‚
     â”‚ 18. Fill Form Data      â”‚                           â”‚                           â”‚                           â”‚                           â”‚                         â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                           â”‚                           â”‚                           â”‚                           â”‚                         â”‚
     â”‚                         â”‚ 19. Validate Form         â”‚                           â”‚                           â”‚                           â”‚                         â”‚
     â”‚                         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚                           â”‚                           â”‚                           â”‚                         â”‚
     â”‚                         â”‚         â”‚                 â”‚                           â”‚                           â”‚                           â”‚                         â”‚
     â”‚                         â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚                           â”‚                           â”‚                           â”‚                         â”‚
     â”‚                         â”‚                           â”‚                           â”‚                           â”‚                           â”‚                         â”‚
     â”‚                         â”‚ 20. POST /api/documents/generate                      â”‚                           â”‚                           â”‚                         â”‚
     â”‚                         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                           â”‚                           â”‚                           â”‚                         â”‚
     â”‚                         â”‚                           â”‚ 21. Route to Generation  â”‚                           â”‚                           â”‚                         â”‚
     â”‚                         â”‚                           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                           â”‚                           â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚ 22. Fetch Template       â”‚                           â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚                           â”‚                         â”‚ 23. Get Template Record
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚                           â”‚                         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚                           â”‚                         â”‚         â”‚
     â”‚                         â”‚                           â”‚                            â”‚ 24. Template Metadata    â”‚                           â”‚                         â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                         â”‚                           â”‚                            â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚                           â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚ 25. Download Template Fileâ”‚                          â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚                           â”‚ 26. Retrieve File        â”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚                           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚                           â”‚         â”‚               â”‚
     â”‚                         â”‚                           â”‚                            â”‚ 27. File Buffer          â”‚                           â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
     â”‚                         â”‚                           â”‚                            â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚                           â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚ 28a. Process DOCX Documentâ”‚                          â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                           â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚ 29a. Easy-Template-X     â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚     Replace Placeholders â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚         â”‚                 â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚ 30a. Processed DOCX      â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                           â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚                           â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚ 28b. Process XLSX Documentâ”‚                          â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                           â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚ 29b. ExcelJS             â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚     Replace Placeholders â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚         â”‚                 â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚ 30b. Processed XLSX      â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                           â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚                           â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚ 31. Convert to PDF (Optional)                        â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                           â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚ 32a. Try LibreOffice     â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚         â”‚                 â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚ 33a. PDF Success         â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                           â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚                           â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚ 32b. LibreOffice Failed  â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚      Try JavaScript       â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚         â”‚                 â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚ 33b. PDF Fallback        â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                           â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚                           â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚ 34. Upload Generated Documents                       â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚                           â”‚ 35a. Store Original      â”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚                           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚                           â”‚         â”‚               â”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚                           â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚                           â”‚ 35b. Store PDF           â”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚                           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚                           â”‚         â”‚               â”‚
     â”‚                         â”‚                           â”‚                            â”‚ 36. Storage URLs          â”‚                           â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
     â”‚                         â”‚                           â”‚                            â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚                           â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚ 37. Create Document Recordâ”‚                          â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚                           â”‚                         â”‚ 38. Insert Document
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚                           â”‚                         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚                           â”‚                         â”‚         â”‚
     â”‚                         â”‚                           â”‚                            â”‚ 39. Document Created     â”‚                           â”‚                         â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                         â”‚                           â”‚                            â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚                         â”‚                           â”‚ 40. Generation Complete   â”‚                           â”‚                           â”‚                         â”‚
     â”‚                         â”‚                           â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                           â”‚                           â”‚                         â”‚
     â”‚                         â”‚ 41. Document + Download URLs                          â”‚                           â”‚                           â”‚                         â”‚
     â”‚                         â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                           â”‚                           â”‚                           â”‚                         â”‚
     â”‚ 42. Show Download Optionsâ”‚                          â”‚                           â”‚                           â”‚                           â”‚                         â”‚
     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                           â”‚                           â”‚                           â”‚                           â”‚                         â”‚
     â”‚                         â”‚                           â”‚                           â”‚                           â”‚                           â”‚                         â”‚
     â”‚ 43. Click Download      â”‚                           â”‚                           â”‚                           â”‚                           â”‚                         â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                           â”‚                           â”‚                           â”‚                           â”‚                         â”‚
     â”‚                         â”‚ 44. GET /download/[id]    â”‚                           â”‚                           â”‚                           â”‚                         â”‚
     â”‚                         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                           â”‚                           â”‚                           â”‚                         â”‚
     â”‚                         â”‚                           â”‚ 45. Route to Download     â”‚                           â”‚                           â”‚                         â”‚
     â”‚                         â”‚                           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                           â”‚                           â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚ 46. Fetch Document       â”‚                           â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚                           â”‚                         â”‚ 47. Get Document Record
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚                           â”‚                         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚                           â”‚                         â”‚         â”‚
     â”‚                         â”‚                           â”‚                            â”‚ 48. Document Metadata    â”‚                           â”‚                         â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                         â”‚                           â”‚                            â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚                           â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚ 49. Download File         â”‚                           â”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                         â”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚                           â”‚ 50. Stream File          â”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚                           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
     â”‚                         â”‚                           â”‚                            â”‚                           â”‚                           â”‚         â”‚               â”‚
     â”‚                         â”‚                           â”‚                            â”‚ 51. File Stream          â”‚                           â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
     â”‚                         â”‚                           â”‚                            â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                         â”‚
     â”‚                         â”‚                           â”‚ 52. File Response         â”‚                           â”‚                           â”‚                         â”‚
     â”‚                         â”‚                           â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                           â”‚                           â”‚                         â”‚
     â”‚                         â”‚ 53. Download Stream       â”‚                           â”‚                           â”‚                           â”‚                         â”‚
     â”‚                         â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                           â”‚                           â”‚                           â”‚                         â”‚
     â”‚ 54. File Downloaded     â”‚                           â”‚                           â”‚                           â”‚                           â”‚                         â”‚
     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                           â”‚                           â”‚                           â”‚                           â”‚                         â”‚
     â”‚                         â”‚                           â”‚                           â”‚                           â”‚                           â”‚                         â”‚

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                 ERROR HANDLING FLOWS                                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    ERROR SCENARIOS              DETECTION POINT               FALLBACK ACTION                 RECOVERY MECHANISM              FINAL RESPONSE
         â”‚                           â”‚                            â”‚                               â”‚                               â”‚
  File Validation Error     â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ Frontend/API Router      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ Return Error Message          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ User Retry
         â”‚                           â”‚                            â”‚                               â”‚                               â”‚
  LibreOffice PDF Failed    â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ Document Processor       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ JavaScript PDF Conversion    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ PDF or Original
         â”‚                           â”‚                            â”‚                               â”‚                               â”‚
  Storage Upload Failed     â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ Supabase Storage         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ Retry Logic                  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ Error or Success
         â”‚                           â”‚                            â”‚                               â”‚                               â”‚
  Database Insert Failed    â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ Database Layer           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ Transaction Rollback         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ Consistency Error
         â”‚                           â”‚                            â”‚                               â”‚                               â”‚
  Processing Engine Failed  â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ Document Processor       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ Return Original Format       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ Limited Functionality
         â”‚                           â”‚                            â”‚                               â”‚                               â”‚

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                               SERVICE RESPONSIBILITIES                                                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

FRONTEND              â”‚  API ROUTER           â”‚  DOCUMENT PROCESSOR      â”‚  EXTERNAL SERVICES    â”‚  STORAGE LAYER        â”‚  DATABASE
                      â”‚                       â”‚                          â”‚                       â”‚                       â”‚
â€¢ User Interface      â”‚  â€¢ Route Handling     â”‚  â€¢ File Type Detection   â”‚  â€¢ Easy-Template-X    â”‚  â€¢ Supabase Storage   â”‚  â€¢ PostgreSQL
â€¢ Form Validation     â”‚  â€¢ Request Validation â”‚  â€¢ Placeholder Extractionâ”‚  â€¢ ExcelJS            â”‚  â€¢ File Upload        â”‚  â€¢ Template Records
â€¢ Progress Display    â”‚  â€¢ Response Formattingâ”‚  â€¢ Document Processing   â”‚  â€¢ LibreOffice        â”‚  â€¢ File Download      â”‚  â€¢ Document Records
â€¢ Error Handling      â”‚  â€¢ Authentication     â”‚  â€¢ PDF Conversion        â”‚  â€¢ JavaScript PDF     â”‚  â€¢ URL Generation     â”‚  â€¢ Relationships
â€¢ State Management    â”‚  â€¢ CORS Handling      â”‚  â€¢ Storage Coordination  â”‚  â€¢ System Commands    â”‚  â€¢ Bucket Management  â”‚  â€¢ Transactions
â€¢ Download Management â”‚  â€¢ Error Propagation  â”‚  â€¢ Database Coordination â”‚  â€¢ Process Management â”‚  â€¢ Security Policies  â”‚  â€¢ Query Optimization
```

This unified flow diagram shows the complete journey from user interaction to file download, including all service handovers, error handling paths, and recovery mechanisms in a single comprehensive visualization.